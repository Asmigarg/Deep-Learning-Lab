# -*- coding: utf-8 -*-
"""Experiment 6(Keras).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v9K8UVbIvoAe-wkZSmqB4cBjo-yTweYC
"""

# Import necessary libraries
import tensorflow as tf
import tensorflow_datasets as tfds
import numpy as np
import matplotlib.pyplot as plt
from tensorflow.keras.preprocessing.text import Tokenizer
from tensorflow.keras.layers import Embedding, LSTM, Dense
from tensorflow.keras.models import Model
from tensorflow.keras.applications import InceptionV3
from tensorflow.keras.applications.inception_v3 import preprocess_input
from tensorflow.keras.preprocessing.sequence import pad_sequences

# Load MS-COCO dataset
# Only use a subset of the dataset for quicker experimentation
data, info = tfds.load("coco_captions", split="train[:1%]", with_info=True)

# Check the dataset structure
for example in data.take(1):
    image = example["image"]
    captions = example["captions"]
    print("Image shape:", image.shape)
    print("Captions:", captions.numpy())